name: Docker Model Runner in GHA

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Install DMR, pull a model, and Run a quick script
      run: | 
        curl -fsSL https://get.docker.com | sudo sh
        docker model pull unsloth/qwen3-gguf:0.6B-UD-Q4_K_XL
        curl -s http://localhost:12434/engines/llama.cpp/v1/chat/completions \
            -H "Content-Type: application/json" \
            -d '{
                "model": "unsloth/qwen3-gguf:0.6B-UD-Q4_K_XL",
                "messages": [
                    {
                        "role": "system",
                        "content": "You are a helpful assistant."
                    },
                    {
                        "role": "user",
                        "content": "Please write 500 words about the fall of Rome."
                    }
                ]
            }'
